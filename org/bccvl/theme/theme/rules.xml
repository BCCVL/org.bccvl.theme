<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <!-- view the unthemed page when using 127.0.0.1 as host header -->
    <notheme if="$host='127.0.0.1'" />
    <!-- don't theme ajax calls (Plone overlays) -->
    <notheme if="$ajax_load" />

    <!-- <notheme if="'true'='true'" /> -->


    <!-- UNIVERSAL RULES ============================================ -->

    <!-- for now, add some of the plone content ~~~~~~~~~~~~~~~~~~~~~ -->
    <after css:theme-children="head" css:content="head link" />

    <after css:theme="nav">
        <div id="visual-portal-wrapper" style="margin:30px; padding-left:30px; border:10px solid #fcc; -webkit-transform:rotate(1deg);">
            <xsl:copy-of css:select="#portal-top" />
            <div style="clear: both"></div>
        </div>
    </after>

    <!-- inject manifest js config ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <after css:theme-children="#js-config">
        window.bccvl || (window.bccvl = {});
        window.bccvl.config || (window.bccvl.config = {});
        window.bccvl.config.visualiser = {
            baseUrl: '<xsl:value-of select="$visualiser_base_url" />',
        };
    </after>

    <!-- update links ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <merge attributes="href" css:theme="a.bccvllinks-home"        content="//a[@id='portal-logo']" />
    <merge attributes="href" css:theme="a.bccvllinks-experiments" content="//li[@id='portaltab-experiments']/a" />

    <!-- NEW SDM EXPERIMENT ========================================= -->
    <rules if-path="++add++org.bccvl.content.experiment/">
        <theme href="html/new-experiment-sdm.html" />

        <!-- place-holder ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    </rules>

    <!-- EXPERIMENT DASHBOARD ======================================= -->
    <rules if-path="experiments/">
        <theme href="html/experiment-dashboard.html" />

        <!-- place-holder ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    </rules>

    <!-- EXPERIMENT RESULTS ========================================= -->
    <rules if-path="view/">
        <theme href="html/experiment-results.html" />

        <!-- place-holder ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    </rules>

</rules>
