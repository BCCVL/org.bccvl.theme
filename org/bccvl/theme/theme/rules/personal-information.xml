<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <!-- USER DETAILS PAGE ============================================ -->

    <rules if-path="@@personal-information/">
        <theme href="html/personal-information.html" />

        <!-- add bootstrap classes to content form -->
        <replace content="form/@class[contains(., 'edit-form')]">
           <xsl:attribute name="class"><xsl:value-of select="."/> form form-horizontal plone-to-bootstrap-form</xsl:attribute>
        </replace>
        <replace content="div/@class[contains(., 'field')]">
           <xsl:attribute name="class"><xsl:value-of select="."/> control-group</xsl:attribute>
        </replace>
        <replace content="form/fieldset/div/img">
         <xsl:copy>
           <xsl:attribute name="class">profile-thumb</xsl:attribute>
           <xsl:copy-of select="@*" />
           <xsl:apply-templates />
         </xsl:copy>
       </replace>
        <replace content="input/@class[contains(., 'context')]">
           <xsl:attribute name="class"><xsl:value-of select="."/> btn</xsl:attribute>
        </replace>
        <replace content="id('form.actions.save')/@class">
           <xsl:attribute name="class"><xsl:value-of select="."/> btn btn-primary</xsl:attribute>
        </replace>
        <replace content="div/@class[contains(., 'widget')]">
           <xsl:attribute name="class"><xsl:value-of select="."/> controls</xsl:attribute>
        </replace>
        <replace content="div/@class[contains(., 'formControls')]">
           <xsl:attribute name="class"><xsl:value-of select="."/> form-actions</xsl:attribute>
        </replace>

        <!-- copy content into theme, drop in theme if not in content -->
        <!-- nav links -->
        <copy attributes="href" css:theme=".bccvllinks-personalinfo" css:content="#contentview-user_data-personal-information a" css:if-content="" />
        <drop theme="//li[a/@class='bccvllinks-personalpref']" css:if-not-content="#contentview-user_data-personal-information"/>
        <copy attributes="href" css:theme=".bccvllinks-personalpref" css:content="#contentview-user_data-personal-preferences a" css:if-content=""/>
        <drop theme="//li[a/@class='bccvllinks-personalpref']" css:if-not-content="#contentview-user_data-personal-preferences"/>
        <copy attributes="href" css:theme=".bccvllinks-oauthpref" css:content="#contentview-user_data-oauth-preferences a" css:if-content=""/>
        <drop theme="//li[a/@class='bccvllinks-oauthpref']" css:if-not-content="#contentview-user_data-oauth-preferences"/>
        <copy attributes="href" css:theme=".bccvllinks-changepassword" css:content="#contentview-user_data-change-password a" css:if-content=""/>
        <drop theme="//li[a/@class='bccvllinks-changepassword']" css:if-not-content="#contentview-user_data-change-password"/>

        <!-- page content -->
        <replace css:theme-children="div#user-info-form" css:content-children="div#content-core" />

    </rules>

</rules>
