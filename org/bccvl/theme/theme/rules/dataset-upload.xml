<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <!-- DATASET UPLOAD ============================================ -->
    <rules if-path="datasets_upload_view/">

        <theme href="html/dataset-upload.html" />

        <!-- Tabs -->
        <before css:theme-children="section.bccvl-datasetupload > div.row-fluid" css:content="ul.nav" />

        <!-- Info notices -->
        <replace css:theme-children=".bccvl-flashmessages-info">
            <xsl:for-each select="//dl[@class='portalMessage info' and not(@style='display:none')]">
                <dl class="bccvl-flashmessage bccvl-flashmessage-info alert alert-block alert-warning">
                    <dt class="label label-important">
                        <xsl:value-of select="./dt" />
                    </dt>
                    <xsl:copy-of select="./dd" />
                </dl>
            </xsl:for-each>
        </replace>
        
    <!-- Species form -->
        <!-- Description -->
        <replace css:theme-children="p.bccvl-occurrencedescription" content="//div[@id='portal-column-content']/div[2]/p[3]/text()" />

        <!-- Form field attributes -->
        <copy attributes="name action method enctype" css:theme="form#addspecies" css:content="form#addspecies" />

        <!-- Submit button -->
        <copy attributes="name value type" css:theme="form#addspecies button[name='addspecies.buttons.save']" css:content="#addspecies-buttons-save" />

        <!-- File field -->
        <copy attributes="name value" css:theme="form#addspecies [name='addspecies.widgets.file']" css:content="#addspecies-widgets-file-input" />

        <!-- Title field-->
        <copy attributes="name value" css:theme="form#addspecies [name='addspecies.widgets.title']" css:content="#addspecies-widgets-title" />

        <!-- Description field-->
        <copy attributes="name value" css:theme="form#addspecies [name='addspecies.widgets.description']" css:content="#addspecies-widgets-description" />
        <replace theme-children="//textarea[@name='addspecies.widgets.description']" content="//textarea[@id='addspecies-widgets-description']/text()" />

        <!-- Dataset Genre field -->
        <replace css:theme-children="form#addspecies [name='addspecies.widgets.datagenre:list']" css:content="#addspecies-widgets-datagenre option" />
        <copy attributes="name" css:theme="form#addspecies [name='addspecies.widgets.datagenre:list']" css:content="#addspecies-widgets-datagenre" />

        <!-- Species Layer field -->
        <replace css:theme-children="form#addspecies [name='addspecies.widgets.specieslayer:list']" css:content="#addspecies-widgets-specieslayer option" />
        <copy attributes="name" css:theme="form#addspecies [name='addspecies.widgets.specieslayer:list']" css:content="#addspecies-widgets-specieslayer" />

        <!-- Scientific name field -->
        <copy attributes="name value" css:theme="form#addspecies [name='addspecies.widgets.scientificName']" css:content="#addspecies-widgets-scientificName" />
        <copy attributes="data-content" css:theme="i.bccvl-scientificnameinfo" css:content="label[for='addspecies-widgets-taxonID'] span.formHelp" />
        
        <!-- Taxon ID field -->
        <copy attributes="name value" css:theme="form#addspecies [name='addspecies.widgets.taxonID']" css:content="#addspecies-widgets-taxonID" />        
        <copy attributes="data-content" css:theme="i.bccvl-taxonidinfo" css:content="label[for='addspecies-widgets-taxonID'] span.formHelp" />

        <!-- Common name field -->
        <copy attributes="name value" css:theme="form#addspecies [name='addspecies.widgets.vernacularName']" css:content="#addspecies-widgets-vernacularName" />
        <copy attributes="data-content" css:theme="i.bccvl-commonnameinfo" css:content="label[for='addspecies-widgets-vernacularName'] span.formHelp" />

    <!-- Layers form -->
        <!-- Description -->
        <replace css:theme-children="p.bccvl-layersdescription" content="//div[@id='portal-column-content']/div[2]/p[6]/text()" />

        <!-- Form field attributes -->
        <copy attributes="name action method enctype" css:theme="form#addlayer" css:content="form#addlayer" />

        <!-- Submit button -->
        <copy attributes="name value type" css:theme="form#addlayer button[name='addlayer.buttons.save']" css:content="#addlayer-buttons-save" />

        <!-- File field -->
        <copy attributes="name value" css:theme="form#addlayer [name='addlayer.widgets.file']" css:content="#addlayer-widgets-file-input" />

        <!-- Title field-->
        <copy attributes="name value" css:theme="form#addlayer [name='addlayer.widgets.title']" css:content="#addlayer-widgets-title" />

        <!-- Description field-->
        <copy attributes="name value" css:theme="form#addlayer [name='addlayer.widgets.description']" css:content="#addlayer-widgets-description" />
        <replace theme-children="//textarea[@name='addlayer.widgets.description']" content="//textarea[@id='addlayer-widgets-description']/text()" />

        <!-- Dataset Genre field -->
        <replace css:theme-children="form#addlayer [name='addlayer.widgets.datagenre:list']" css:content="#addlayer-widgets-datagenre option" />
        <copy attributes="name" css:theme="form#addlayer [name='addlayer.widgets.datagenre:list']" css:content="#addlayer-widgets-datagenre" />

        <!-- Dataset Type field -->
        <replace css:theme-children="form#addlayer [name='addlayer.widgets.datatype:list']" css:content="#addlayer-widgets-datatype option" />
        <copy attributes="name" css:theme="form#addlayer [name='addlayer.widgets.datatype:list']" css:content="#addlayer-widgets-datatype" />

        <!-- Resolution field -->
        <replace css:theme-children="form#addlayer [name='addlayer.widgets.resolution:list']" css:content="#addlayer-widgets-resolution option" />
        <copy attributes="name" css:theme="form#addlayer [name='addlayer.widgets.resolution:list']" css:content="#addlayer-widgets-resolution" />

        <!-- Resolution (other) field-->
        <copy attributes="name value" css:theme="form#addlayer [name='addlayer.widgets.resolutiono']" css:content="#addlayer-widgets-resolutiono" />

        <!-- Temporal Start -->
        <copy attributes="name value maxlength size" css:theme="form#addlayer [name='addlayer.widgets.temporal.start-day']" css:content="#addlayer-widgets-temporal-start-day" />
        <copy attributes="name value maxlength size" css:theme="form#addlayer [name='addlayer.widgets.temporal.start-month']" css:content="#addlayer-widgets-temporal-start-month" />
        <copy attributes="name value maxlength size" css:theme="form#addlayer [name='addlayer.widgets.temporal.start-year']" css:content="#addlayer-widgets-temporal-start-year" />
        <copy attributes="name value" css:theme="form#addlayer [name='addlayer.widgets.temporal.starttext']" css:content="#addlayer-widgets-temporal-starttext" />

        <!-- Temporal End -->
        <copy attributes="name value maxlength size" css:theme="form#addlayer [name='addlayer.widgets.temporal.end-day']" css:content="#addlayer-widgets-temporal-end-day" />
        <copy attributes="name value maxlength size" css:theme="form#addlayer [name='addlayer.widgets.temporal.end-month']" css:content="#addlayer-widgets-temporal-end-month" />
        <copy attributes="name value maxlength size" css:theme="form#addlayer [name='addlayer.widgets.temporal.end-year']" css:content="#addlayer-widgets-temporal-end-year" />
        <copy attributes="name value" css:theme="form#addlayer [name='addlayer.widgets.temporal.endtext']" css:content="#addlayer-widgets-temporal-endtext" />

        <!-- Emission Scenario -->
        <replace css:theme-children="form#addlayer [name='addlayer.widgets.emissionscenario:list']" css:content="#addlayer-widgets-emissionscenario option" />
        <copy attributes="name" css:theme="form#addlayer [name='addlayer.widgets.emissionscenario:list']" css:content="#addlayer-widgets-emissionscenario" />

        <!-- Global Climate Model -->
        <replace css:theme-children="form#addlayer [name='addlayer.widgets.gcm:list']" css:content="#addlayer-widgets-gcm option" />
        <copy attributes="name" css:theme="form#addlayer [name='addlayer.widgets.gcm:list']" css:content="#addlayer-widgets-gcm" />

    </rules>
</rules>
