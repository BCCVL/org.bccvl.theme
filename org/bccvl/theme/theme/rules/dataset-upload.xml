<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <!-- EXPERIMENT LIST ============================================ -->
    <rules if-path="datasets/++add++File">

        <theme href="html/dataset-upload.html" />

        <!--
            don't theme the page unless the expected file input on it. This is required
            because the plone form posts back to the same URL, and we don't want to mess
            that up.
        -->
        <notheme css:if-not-content="#form-widgets-file-input" />

        <!-- hook in the new experiment form's attributes -->
        <copy attributes="name action method enctype" css:theme="form#uploadDataset" css:content="#form" />

        <!-- hook in the submit (save) button -->
        <copy attributes="name value type" css:theme="form#uploadDataset button[name='saveButton']" css:content="#form-buttons-save" />

        <!-- hook in file field -->
        <copy attributes="name value" css:theme="form#uploadDataset [name='datasetFile']" css:content="#form-widgets-file-input" />

        <!-- hook in title and description fields -->
        <copy attributes="name value" css:theme="form#uploadDataset [name='datasetTitle']" css:content="#form-widgets-title" />
        <copy attributes="name value" css:theme="form#uploadDataset [name='datasetDescription']" css:content="#form-widgets-description" />
        <replace theme-children="//textarea[@name='datasetDescription']" content="//textarea[@id='form-widgets-description']/text()" />

        <!-- who knows, maybe this is the missing required field. -->
        <after css:theme-children="form#uploadDataset" content="//textarea[@id='form-widgets-IOwnership-creators']" />

    </rules>
</rules>
